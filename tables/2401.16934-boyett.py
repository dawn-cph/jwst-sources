from grizli import utils
import numpy as np

tab = utils.read_catalog("""
======== ===== ====== ========== ==== ======== ===== ======= ===== ========
      id     z ewoiii ewoiii_err ewha ewha_err   Muv Muv_err  beta beta_err
======== ===== ====== ========== ==== ======== ===== ======= ===== ========
10058975  9.44    856         75   -1       -1 -20.4     0.1 -2.59     0.01
   21842  7.98   1246         37   -1       -1 -18.7     0.1 -2.23     0.01
10013682  7.28   2767        763   -1       -1 -15.7     1.4 -1.85     0.04
10013905  7.21    844         77   -1       -1 -18.8     0.1 -2.46     0.01
    4297  6.72   1971         39 1721       88 -18.5     0.1 -2.29     0.02
    3334  6.71   1620         72 1558      307 -18.1     0.1 -2.08     0.02
   16625  6.63   1444         29 1978       97 -18.8     0.1 -2.29     0.01
   18846  6.34   1068         21 1185       24 -20.2     0.1 -2.53     0.01
   18976  6.33    839         30  620       43 -18.7     0.1  -2.3     0.01
   19342  5.98   2090         72 1072       76 -18.7     0.1 -2.51     0.01
    9422  5.94   3253         65 2214       44 -19.7     0.1 -2.31     0.01
    6002  5.94    870         20  619       26 -18.8     0.1 -2.52     0.01
   19606  5.89    962         21  941       36 -18.6     0.1  -2.6     0.02
10056849  5.82   1022        209 1249      256 -18.0     0.1 -2.52     0.01
10005113  5.82   2107        103 1565      109 -18.0     0.1 -2.23     0.02
   22251   5.8   1318         26  857       18 -19.0     0.1 -2.02     0.01
    4404  5.78   1035         21  793       26 -19.3     0.1 -2.31     0.01
10016374  5.51   1758        186 1337      143 -18.7     0.1 -2.21     0.01
    9743  5.45    897         35  996       40 -17.4     0.7  -1.3     0.05
10015338  5.07   1639        187 1712      202 -19.5     0.1 -2.42     0.01
    8113   4.9    943         19  739       17 -18.1     0.2 -1.69     0.01
10005217  4.89   1086         24 1546       37 -18.1     0.1 -2.32     0.01
    7938  4.82    891         18  620       12 -19.4     0.1  -2.4     0.01
   18090  4.79    976         20  768       15 -18.9     0.1 -1.92     0.01
10001892  4.77    663        176 1113      308 -16.0     0.6 -1.69     0.04
    8083  4.67   1808         36 1362       27 -18.7     0.1 -1.57     0.01
10000626  4.47    763         42  923       45 -17.0     0.5 -2.13     0.04
10001916  4.28    823         87 1322      202 -16.7     0.7  -1.8     0.08
    7892  4.25    820         16  677       14 -18.5     0.1 -2.15     0.01
    6519  4.24   1461         31  849       18 -19.2     0.1 -2.25     0.01
    7507  4.04    765         20  738       15 -18.8     0.1 -2.44     0.01
    4270  4.02   1030         21  814       16 -18.9     0.1 -1.68     0.01
10035295  3.58   1255         43  870       25 -18.1     0.1 -1.92     0.01
    2651  3.58    840        113  529       36 -16.3     1.0 -1.42     0.05
   18322  3.16   1363         41 1432       29 -16.9     0.5 -2.19     0.05
   21150  3.09    816         16  511       11 -19.2     0.9 -2.36     0.01
======== ===== ====== ========== ==== ======== ===== ======= ===== ========
    """,
    format="ascii.rst",
)

bunker = utils.read_catalog("2306.02467-bunker.csv")
bids = bunker["id"].tolist()
idx = [bids.index(id_) for id_ in tab["id"]]

for c in ["ra","dec","zspec"]:
    tab[c] = bunker[c][idx]

tab.write('2401.16934-boyett.csv', format="csv", overwrite=True)